steps:  
  - checkout: self

  - task: AzureKeyVault@1
    displayName: PullSecrets
    inputs:
      azureSubscription: $(azureSubscription)-$(projectName)
      KeyVaultName: $(KeyVaultName)
      SecretsFilter: 'VERCEL-LMG-TOKEN'
      RunAsPreJob: true

  - script: |
        echo '##vso[task.setvariable variable=VERCEL_ORG_ID]$(VERCEL-ORG-ID)'  
        echo '##vso[task.setvariable variable=VERCEL_PROJECT_ID]$(VERCEL-PROJECT-ID)'
    displayName: 'Set environment variables'

  - task: Bash@3
    inputs:
      targetType: 'inline'
      script: |
        # Write your commands here
        cd $(system.defaultworkingdirectory)
        vercel $(env-parameter) --token=f1YsKlnkwO7HZxwyBanUQafu
    # env:
    #     VERCEL_ORG_ID: eSg7BpD1cgHfbwUHUPO7d5KO
    #     #VERCEL_TEAM_ID: team_tQvEJvJXhbz2wo3OQm663oH5
    #     VERCEL_PROJECT_ID: prj_nribQrSbvJ7GA5bgJkuyuir5YmeP
    displayName: 'Vercel build and deployment' 

